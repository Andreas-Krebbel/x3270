<!DOCTYPE doctype PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
    <head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link href="http://www.w3.org/StyleSheets/Core/Steely" type="text/css"
	    rel="stylesheet">
	<title>suite3270 Build and Install Instructions</title>
    </head>
    <body>

	<h1>suite3270 Build and Install Instructions</h1>

	<h2>Windows Version Upgrades</h2>
	Release 3.5alpha5 stopped the use of the wc3270 AppData folders. When
	upgrading from an earlier release to 3.5alpha5 or later, any files
	in an wc3270 AppData folder must be copied elsewhere (usually onto
	the user's Desktop or My Documents folder). An Upgrade Wizard will be
	run automatically to handle this, allowing user control over where the
	files are copied. (Note that with unattended installation, the Upgrade
	Wizard will <b>not</b> be run.)
	<p>
	Release 3.5alpha4 was the first with 64-bit Windows support. When
	upgrading from an earlier release to 3.5alpha4 or later on 64-bit
	Windows, the earlier 32-bit version must be uninstalled before 64-bit
	installation can proceed. This will be done automatically by the 64-bit
	installer (with the user's permission; if installing unattended, it
	will always be performed).
	<h2>Windows Installer Options</h2>
	The Windows installer for wc3270 uses Inno Setup. Complete
	documentation for the command-line options is here:
	<p><a href="http://www.jrsoftware.org/ishelp/index.php?topic=setupcmdline">http://www.jrsoftware.org/ishelp/index.php?topic=setupcmdline</a>
	<p>Options of interest are:</p>
	<table cols=2 width="75%">
	    <tr>
		<th>Option</th>
		<th>Purpose</th>
	    </tr>
	    <tr>
		<td>/SILENT</td>
		<td>Run the installer without user interation</td>
	    </tr>
	    <tr>
		<td>/COMPONENTS="component,component..."</td>
		<td>Install only specific <a href="#components">components</a></td>
	    </td>
	    <tr>
		<td>/TASKS="task,task..."</td>
		<td>Perform only specific install <a href="#tasks">tasks</a></td>
	    </td>
	</table>
	<p>By default, all components are installed. The set of components
	   that can be specified are:</p>
	<a name="components"></a><table cols=2 width="75%">
	    <tr>
		<th>Component</th>
		<th>Definition</th>
	    </tr>
	    <tr>
		<td>base</td>
		<td>wc3270.exe (interactive emulator)<br>
		    wpr3287.exe (printer session emulator)<br>
		    catf.exe (helper program for displaying trace files)<br>
		    root_certs.txt (root CA certificate database)</td>
	    </tr>
	    <tr>
		<td>wizard</td>
		<td>wc3270wiz.exe (Session Wizard)</td>
	    </tr>
	    <tr>
		<td>ws3270</td>
		<td>ws3270.exe (scripting emulator)<br>
		    x3270if.exe (command-line interface to ws3270 and wc3270 scrpting)</td>
	    </tr>
	    <tr>
		<td>help</td>
		<td>HTML documentation</td>
	    </tr>
	</table>
	<p>By default, all tasks are performed. The set of tasks that can be specified are:</p>
	<a name="tasks"><table cols=2 width="75%">
	    <tr>
		<th>Task</th>
		<th>Definition</th>
	    </tr>
	    <tr>
		<td>desktopicons</td>
		<td>Create desktop shortcuts to wc3270 and the Session
		    Wizard</td>
	    </tr>
	    <tr>
		<td>migratefiles</td>
		<td>Copy session files from the AppDefaults folders (from older
		    versions of wc3270) to Documents folders</td>
	    </tr>
	</table>
	<h2>Building on Unix or Cygwin</h2>
	To build the entire 3270 emulation suite, including native Unix
	programs and cross-compiled Windows programs, use:  
	<pre><tt>   ./configure
   make depend
   make</tt></pre>
	(The <tt>make depend</tt> step is optional, but is helpful to ensure
	that things will be rebuild if you change a header file.)
	<p>
	To install Unix binaries in the default install directory
	(<tt>/usr/local</tt>), use:  
	<pre><tt>   make install</tt></pre>
	To install Unix manual pages, use:
	<pre><tt>   make install.man</tt></pre>
	To remove intermediate files, use:
	<pre><tt>   make clean</tt></pre>
	To remove all derived files, use:
	<pre><tt>   make clobber</tt></pre>

	<h3>Selective build targets</h3>
	To build just the Unix programs, use:
	<pre><tt>   make unix</tt></pre>
	To cross-compile just the Windows programs, use:
	<pre><tt>   make windows</tt></pre>
	To build an individual program, such as s3270, just make it:
	<pre><tt>   make s3270</tt></pre>
	Each of the top-level symbolic targets can be limited to a group
	(unix or windows) or to a program, by adding the desired prefix:
	<pre><tt>   make <i>group</i>-depend
   make <i>program</i>-depend
   make unix-install
   make unix-install.man
   make <i>program</i>-install
   make <i>program</i>-install.man
   make <i>group</i>-clean
   make <i>program</i>-clean
   make <i>group</i>-clobber
   make <i>program</i>-clobber</tt></pre>

	<h3>Selective ./configure</h3>
	If you only want to build a subset of the programs, you can limit the
	scope of the configure script with the following options. Note that the
	options are cumulative, so you can specify exactly the set of programs
	you want:
	<table border="3" cellspacing="3" cellpadding="3">
	    <tbody>
		<tr>
		    <td><tt>--enable-unix</tt></td>
		    <td>Include all of the Unix programs</td>
		</tr>
		<tr>
		    <td><tt>--enable-windows</tt></td>
		    <td>Include all of the Windows programs</td>
		</tr>
		<tr>
		    <td><tt>--enable-x3270</tt></td>
		    <td>Include x3270</td>
		</tr>
		<tr>
		    <td><tt>--enable-c3270</tt></td>
		    <td>Include c3270</td>
		</tr>
		<tr>
		    <td><tt>--enable-s3270</tt></td>
		    <td>Include s3270</td>
		</tr>
		<tr>
		    <td><tt>--enable-tcl3270</tt></td>
		    <td>Include tcl3270</td>
		</tr>
		<tr>
		    <td><tt>--enable-pr3287</tt></td>
		    <td>Include pr3287</td>
		</tr>
		<tr>
		    <td><tt>--enable-ws3270</tt></td>
		    <td>Include ws3270</td>
		</tr>
		<tr>
		    <td><tt>--enable-wc3270</tt></td>
		    <td>Include wc3270</td>
		</tr>
		<tr>
		    <td><tt>--enable-wpr3287</tt></td>
		    <td>Include wpr3287</td>
		</tr>
	    </tbody>
	</table>
	When you limit the configuration this way, it changes the top-level
	make targets, so <tt>make</tt>, <tt>make depend</tt>, <tt>make
	install</tt>, <tt>make clean</tt> and <tt>make clobber</tt> will
	operate only on the programs you have configured.

	<h2>Cross-Compiling 64-Bit Windows Binaries</h2>
	To cross-compile 64-bit versions of the emulators on Unix or Cygwin,
	set the WIN64 variable, e.g.:
	<pre><tt>   make WIN64=1</tt></pre>

	<h2>Building Windows Programs with Visual Studio (GUI)</h2>
	The Visual Studio solution is called <tt>suite3270.sln</tt> in the
	<tt>VS2013</tt> folder. There are individual projects for each of the
	programs and components. The Debug and Release configurations build
	code without OpenSSL support. The SSL-Debug and SSL-Release
	configurations build code with OpenSSL support, and require standard
	OpenSSL header files to be installed in the folder
	<tt>C:\OpenSSL-Win32\include</tt>.

	<h2>Building Windows Programs with Visual Studio (Command Line)</h2>
	To build with Microsoft Visual Studio from the command prompt, first
	open a command console with Visual Studio build environment variables
	set. Switch to the <tt>VS2013</tt> directory, and type:
	<pre><tt>   msbuild</tt></pre>
	The usual msbuild options are available, such as <b>/m</b>,
	<b>/p:Configuration</b> (which can specify Debug, Release, SSL-Debug
	or SSL-Release) and <b>/p:Platform</b> (which can specify x86 or x64).

	<h2> Summary of common <tt>configure</tt> Options</h2>
	The top-level <tt>configure</tt> script accepts the following
	options. Note that these apply only to Unix; the options for Windows
	programs are fixed.
	<table border="3" cellspacing="3" cellpadding="3">
	    <tbody>
		<tr>
		    <td><tt>--help</tt></td>
		    <td>Print a help message.</td>
		</tr>
		<tr>
		    <td><tt>--prefix=<i>prefix</i></tt></td>
		    <td>Install architecture-independent files under
			<i>prefix</i> (defaults to <tt>/usr/local</tt>)</td>
		</tr>
		<tr>
		    <td><tt>--exec-prefix=<i>eprefix</i></tt></td>
		    <td>Install architecture-dependent files (executables) under
			<i>eprefix</i> (defaults to same as <i>prefix</i>)</td>
		</tr>
		<tr>
		    <td><tt>--bindir=<i>dir</i></tt></td>
		    <td>Install user executables <i>dir</i> (defaults to
			<tt><i>eprefix</i>/bin</tt>)&nbsp;</td>
		</tr>
		<tr>
		    <td><tt>--sysconfdir=<i>dir</i></tt></td>
		    <td>Install configuration files (<tt>ibm_hosts</tt>,
			character sets) in <i>dir</i> (defaults to
			<tt><i>prefix</i>/etc</tt>).</td>
		</tr>
		<tr>
		    <td><tt>--disable-apl</tt></td>
		    <td>Leave out APL character support.</td>
		</tr>
		<tr>
		    <td valign="top"><tt>--disable-dbcs</tt></td>
		    <td valign="top">Leave out DBCS (Double Byte Character Set)
			support.
		</td>
		</tr>
		<tr>
		    <td><tt>--disable-local-process</tt></td>
		    <td>Leave out local process (connecting to
			"-e <i>shell_command</i>") support.
			This will be automatically disabled if the local system
			does not support the <i>forkpty</i>() library call.</td>
		</tr>
		<tr>
		    <td valign="top"><tt>--disable-ssl</tt></td>
		    <td valign="top">Leave out SSL (Secure Sockets Layer)
			support. SSL support requires the OpenSSL library.
		    </td>
		</tr>
		<tr>
		    <td valign="top"><tt>--with-ssl=<i>dir</i></tt></td>
		    <td valign="top">Specify the directory where the OpenSSL
			library is installed.
		    </td>
		</tr>
	    </tbody> 
	</table>
	There are also <tt>configure</tt> options that are specific to
	individual programs. These can be passed to the top-level
	<tt>configure</tt> script. See each individual program's additional
	build information for details.
	<ul>
	    <li><a href="Build-x3270.html">x3270</a></li>
	    <li><a href="Build-c3270.html">c3270</a></li>
	    <li><a href="Build-tcl3270.html">tcl3270</a></li>
	</ul>

    <h2>Notes for Cygwin</h2>
    The minimum set of extra Cygwin packages needed to build the 3270 suite
    are:
    <ul>
	<li>The <b>make</b> package from the <b>Devel</b> group</li>
	<li>The <b>gcc-core</b> package from the <b>Devel</b> group</li>
	<li>For SSL support, the <b>openssl-devel</b> package from
	    the <b>Devel</b> group</li>
    </ul>
    To cross-compile native Windows binaries, you need this package:
    <ul>
	<li><b>mingw-w64-gcc</b> from the <b>Devel</b> group</li>
    </ul>
    Other packages are needed by the specific programs, and are listed in those
    programs' build instructions.

    <h2>Notes for MacOS X</h2>
    Everything except x3270 is built the usual (Unix) way on MacOS X.
    But to build x3270, you first need to install XQuartz (<a
	href="http://xquartz.macosforge.org/">http://xquartz.macosforge.org/</a>).
    Then to build all of the emulators, use the following commands:
    <pre><tt>   export PATH=$PATH:/opt/X11/bin
   ./configure --enable-unix --x-includes=/opt/X11/include
   make depend
   make</tt></pre>

    <h2>Notes for Solaris 2.x and Sun's C Compiler</h2>
    Do not use Sun's BSD-compatibility compiler, <tt>/usr/ucb/cc</tt>. This
    is good advice in general, but in particular, the 3270 suite will not build
    with it. You should have a directory containing <tt>gcc</tt> (recommended)
    or Sun's standard compiler in your $PATH ahead of <tt>/usr/ucb</tt>.

    <h2>Building on FreeBSD</h2>
    FreeBSD's <b>iconv</b> library is installed in <tt>/usr/local</tt>, so
    the the following options must be passed to the <tt>configure</tt> script:
    <pre><tt>   ./configure LDFLAGS=-L/usr/local/lib CPPFLAGS=-I/usr/local/include</tt></pre>

    </body>
</html>
